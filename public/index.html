<!Doctype html>
<html lang="fr"></html>
<head>
  <meta charset="UTF-8"/>
  <title>Devine L'Album!</title>
  <script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="/socket.io/socket.io.js"></script>
  <style>
    .messages{
    	background: #ddd;
    	border: 1px solid #333;
    	padding: .5em .1em;
    	min-height : 300px;
    	margin-bottom: 20px;
		width: 800px;
    }
    img{
    	height: 600px;
		width: 800px;
    }
	
	.row {
	display: flex;
	}

	/* Create two equal columns that sits next to each other */
	.column {
	flex: 50%;
	padding: 10px;
	height: 300px; /* Should be removed. Only for demonstration */
	}
	
	html, body {
  width: 100%;
  height:100%;
}
	
	body {
    background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
    background-size: 400% 400%;
    animation: gradient 15s ease infinite;
}

@keyframes gradient {
    0% {
        background-position: 0% 50%;
    }
    50% {
        background-position: 100% 50%;
    }
    100% {
        background-position: 0% 50%;
    }
}

  </style>
  <script>
   	var socket = io();
	socket.on('updateVote',function(data)
			{
				console.log("ajout val");
				$("#votes").html("");
				Object.keys(data).map( (key,value) => {
					$("#votes").append(
						`
						<li> 
							<strong> ${key} </strong>
							${data[key]} 
						</li>
						`
					);
				});
			});
			
    socket.on('addimage',function(msg,base64image){
    	$('.messages').empty();
		$('.messages')
    	.prepend(
    		$('<p>').append($('<b>').text(""),'<a target="_blank" href="'+ base64image +'"><img src="'+ base64image+'" /></a>'
    		)
    	);
    });
    
    $(function(){
    	$("#imageFile").on('change',function(e){
    		var file = e.originalEvent.target.files[0];
    		var reader = new FileReader();
    		reader.onload = function(evt){
    			socket.emit('user image',evt.target.result);
    		};
    		reader.readAsDataURL(file);
    	});
		
		$("input[type=radio][name=vote]").on('change', function () 
			{
				console.log(this.value);
				socket.emit('vote', this.value);
				this.checked = false;
			});
	});
	    
  </script>
</head>
<body>

  <div class="row">
	<div class="column">
		<div class="messages"></div>
		<input type="file" id="imageFile"/>
	</div>
	<div class="column">
		<h2>Classement de cons</h2>
		<form action="">
			<label for="">Kirai</label>
			<input type="radio" name="vote" id="Kirai" value="Kirai">
			<label for="">Extarns</label>
			<input type="radio" name="vote" id="Extarns" value="Extarns">
			<label for="">Oinnez</label>
			<input type="radio" name="vote" id="Oinnez" value="Oinnez">
			<label for="">Mattéo</label>
			<input type="radio" name="vote" id="Mattéo" value="Mattéo">
		</form>
	
		<ul id="votes"></ul>
	</div>
  </div>
	
</body>
